(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["watch-update"]=t(require("vue")):e["watch-update"]=t(e["Vue"])})("undefined"!==typeof self?self:this,(function(e){return function(){"use strict";var t={203:function(t){t.exports=e}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,o),i.exports}!function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p=""}();var r={};return function(){if(o.r(r),o.d(r,{default:function(){return C}}),"undefined"!==typeof window){var e=window.document.currentScript,t=e&&e.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);t&&(o.p=t[1])}var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"update-modal"},[t("div",{staticClass:"title"},[e._v("系统更新🚀")]),t("div",{staticClass:"content"},[e._v(" 系统已更新，请刷新页面（请在刷新前注意保存当前页面数据）。 ")]),t("div",{staticClass:"actions"},[t("button",{on:{click:e.handleAfterLeave}},[e._v("忽略")]),t("button",{on:{click:e.refresh}},[e._v("刷新")])])])},i=[],s={methods:{handleAfterLeave(){this.$destroy(!0),this.$el.parentNode.removeChild(this.$el)},refresh(){this.handleAfterLeave(),location.reload(!0)}}},a=s;function l(e,t,n,o,r,i,s,a){var l,u="function"===typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),o&&(u.functional=!0),i&&(u._scopeId="data-v-"+i),s?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=l):r&&(l=a?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}var u=l(a,n,i,!1,null,"2843c149",null),c=u.exports,d=o(203),f=o.n(d);let p=0,v="",h=!0;console.log("production",h,"prodFlag");let _=null,m=async()=>{if(p>=5)return clearInterval(_),_=null;let e=await fetch(`/version.txt?v=${(new Date).getTime().toString()}`).then((e=>e.json())).catch((e=>(console.log(e),y())));if(v){if(v!=e){console.log("发现版本更新",v);let e=f().extend(c),t=new e({data:{}});return t.id=(new Date).getTime().toString(),t.$mount(),document.body.appendChild(t.$el),y()}}else v=e,console.log("首次加载版本",v);p++},w=()=>{h&&(p=0,_||(_=setInterval(m,1e3)))};h&&(_=setInterval(m,5e3)),window.addEventListener("mousemove",w);let y=()=>{clearInterval(_),window.removeEventListener("mousemove",w),_=null};const g=[],b=function(e){b.installed||g.forEach((t=>{e.component(t.name,t)}))};"undefined"!==typeof window&&window.Vue&&b(window.Vue);var x={install:b,...g},C=x}(),r}()}));
//# sourceMappingURL=watch-update.umd.min.js.map